# Inovelli VZM31-SN mmWave Presence Package
#
# Prerequisites:
#   - mmWaveTargetInfoReport must be set to "Enable" on the device
#   - manuSpecificInovelliMMWave cluster must be bound to EP1
#   - Visualizer add-on handles target tracking display

# ==============================================================================
# Automations
# ==============================================================================
automation:
  - alias: "Master Presence: Dynamic mmWave Tuning"
    id: master_presence_dynamic_mmwave_tuning
    description: "Adjusts Stay Life and Hold Time for sleep vs daytime use."
    trigger:
      - platform: time
        at: "23:00:00"
        id: "night"
      - platform: time
        at: "10:00:00"
        id: "day"
    action:
      - choose:
          # NIGHT MODE: High sensitivity, long stay life
          - conditions:
              - condition: trigger
                id: "night"
            sequence:
              - action: number.set_value
                target:
                  entity_id: number.master_presence_mmwavestaylife
                data:
                  value: 36000
              - action: number.set_value
                target:
                  entity_id: number.master_presence_mmwaveholdtime
                data:
                  value: 300
              - action: select.select_option
                target:
                  entity_id: select.master_presence_mmwavedetectsensitivity
                data:
                  option: "High (default)"
              - action: select.select_option
                target:
                  entity_id: select.master_presence_mmwavecontrolwireddevice
                data:
                  option: "Disabled"

          # DAY MODE: Standard sensitivity, fast turn-off
          - conditions:
              - condition: trigger
                id: "day"
            sequence:
              - action: number.set_value
                target:
                  entity_id: number.master_presence_mmwavestaylife
                data:
                  value: 600
              - action: number.set_value
                target:
                  entity_id: number.master_presence_mmwaveholdtime
                data:
                  value: 30
              - action: select.select_option
                target:
                  entity_id: select.master_presence_mmwavedetectsensitivity
                data:
                  option: "Medium"
              - action: select.select_option
                target:
                  entity_id: select.master_presence_mmwavecontrolwireddevice
                data:
                  option: "Occupancy (default)"
    mode: restart
